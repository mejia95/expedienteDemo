import{b as s,j as H,d as _,e,w as t,f as a,h as d,l as q,c as b,i as F,t as r,n as Y,v as O,F as B,C as $,r as p,p as R,q as le,D as ne,k as ae,M as X,g as S,o as ie,N as re,m as ee,a as ce,z as de,y as me}from"./app-bY3qV11d.js";/* empty css                                                                  */import{_ as pe}from"./App-DXzjI6g8.js";import{A as se}from"./AppAlerta-CEk7FTVV.js";import{A as Z}from"./AppStore-B5dmMze3.js";import{_ as J}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{h as te}from"./moment-C5S46NFB.js";/* empty css            */const _e={components:{AppAlerta:se},setup(){const V=$("GetHistorialImportaciones"),o=Z(),I=p(null),l=p(!1),g=p(!1),D=p(0),m=p([]),n=p(null),c=p(null),u=p(!1),k=()=>{n.value.click()},f=async x=>{const M=x.target.files[0];if(M){u.value=!0;try{const i=await axios.post("/importaciones/validar-importacion",{archivo:M},{headers:{"Content-Type":"multipart/form-data"}});D.value=i.data.registros_a_importar,m.value=i.data.registros_no_importar,c.value=i.data.mdUID,l.value=!0}catch(h){console.error("Error:",h),o.MostrarAlerta=!0,o.CallbackAlerta=null,console.log(h),o.MensajeAlerta=h.response.data.message??"Ha ocurrido un error",o.TituloAlerta="Error",o.IconoAlerta="mdi-close-circle",g.value=!1,l.value=!1}finally{u.value=!1,x.target.value=""}}},w=async()=>{g.value=!0,await axios.post("/importaciones/nueva",{mdUID:c.value},{timeout:3e4}).then(x=>{o.CallbackAlerta="GuardarSeccion",console.log("Que traes en  StoreApp.CallbackAlerta",o.CallbackAlerta),o.MensajeAlerta="El proceso de importacion se ha completado con exito",o.EstadoAlerta=2,o.TituloAlerta="Exito",o.IconoAlerta="mdi-check-circle",g.value=!1,l.value=!1}).catch(x=>{o.CallbackAlerta=null,console.log(x),o.EstadoAlerta=0,o.MensajeAlerta=x.response.data.message??"Ha ocurrido un error",o.TituloAlerta="Error",o.IconoAlerta="mdi-close-circle",g.value=!1,l.value=!1}).finally(()=>{o.MostrarAlerta=!0})};return R("FuncionesPadre",{GuardarSeccion:async()=>{console.log("Ok se importaron y se cierra"),await o.OcultarAlerta(),await V()}}),{CargaImportacion:g,MostrarHistorialImportaciones:V,archivoImportacion:n,PreImportacionModal:l,DisponiblesdeImportacion:D,NoDisponiblesdeImportacion:m,ImportacionMedicos:w,openFileDialog:k,handleFileSelect:f,callback:I,isLoading:u}}},ue={class:"d-flex align-center px-4 py-2 rounded-t-lg"},ve={class:"poppins-semibold"},fe={class:"font-weight-bold",style:{"font-size":"1.3rem"}},ge={class:"d-flex flex-column my-2"},xe={class:"text-medium-emphasis",style:{"font-size":"0.775rem"}},ye={class:"d-flex align-center gap-2"},be={class:"d-flex align-center"},he={class:"d-flex align-center gap-2"},ke={class:"d-flex align-center"},Ie={class:"poppins-medium text-medium-emphasis text-caption"},Ce={class:"d-flex align-center mx-2"},we={class:"poppins-medium text-medium-emphasis text-caption"},Ae={key:0,class:"d-flex justify-center align-center py-8"},ze={class:"d-flex align-center px-4 py-2"},Fe={class:"poppins-semibold"},De={class:"font-weight-bold text-red",style:{"font-size":"1.3rem"}},Me={class:"d-flex flex-column my-2"},Pe={class:"text-medium-emphasis",style:{"font-size":"0.775rem"}},Ve={class:"d-flex align-center gap-2"},Ne={class:"d-flex align-center"},Le={class:"d-flex align-center gap-2"},Se={class:"d-flex align-center"},Ue={class:"poppins-medium text-medium-emphasis text-caption"},He={class:"d-flex align-center mx-2"},je={class:"poppins-medium text-medium-emphasis text-caption"},Re={class:"d-flex align-center mt-1"},Ee={class:"poppins-semibold text-grey-darken-2",style:{"font-size":"0.775rem"}},qe={key:0,class:"d-flex justify-center align-center py-8"};function $e(V,o,I,l,g,D){const m=s("v-btn"),n=s("v-empty-state"),c=s("v-col"),u=s("v-row"),k=s("v-card-title"),f=s("v-icon"),w=s("v-expansion-panel-title"),N=s("v-avatar"),x=s("v-list-item-title"),M=s("v-chip"),h=s("v-list-item"),i=s("v-divider"),y=s("v-virtual-scroll"),v=s("v-list"),L=s("v-expansion-panel-text"),P=s("v-expansion-panel"),C=s("v-expansion-panels"),j=s("v-progress-circular"),T=s("v-card-text"),U=s("v-spacer"),G=s("v-card-actions"),Q=s("v-card"),K=s("v-bottom-sheet"),W=s("AppAlerta");return _(),H(B,null,[e(u,{class:"my-4 mx-5","no-gutters":""},{default:t(()=>[e(c,{cols:"12"},{default:t(()=>[e(n,{icon:"mdi-upload",text:"Para comenzar a importar médicos pasantes de servicio social, haz clic en el botón 'Importar' que se encuentra debajo.",title:"Importar médicos pasantes de servicio social"},{actions:t(()=>[a("input",{type:"file",ref:"archivoImportacion",class:"d-none",accept:".xlsx,.xls,.csv",onChange:o[0]||(o[0]=(...A)=>l.handleFileSelect&&l.handleFileSelect(...A))},null,544),e(m,{color:"primary",disabled:l.isLoading,rounded:"lg",onClick:l.openFileDialog},{default:t(()=>o[3]||(o[3]=[d("Importar")])),_:1,__:[3]},8,["disabled","onClick"])]),_:1})]),_:1})]),_:1}),e(K,{inset:"",modelValue:l.PreImportacionModal,"onUpdate:modelValue":o[2]||(o[2]=A=>l.PreImportacionModal=A),scrim:"black",opacity:"0.80",persistent:"","max-height":"750"},{default:t(({isActive:A})=>[e(Q,{rounded:"t-lg"},{default:t(()=>[e(k,{class:"d-flex align-center"},{default:t(()=>[e(u,{"no-gutters":"",class:"pa-4"},{default:t(()=>[e(c,{cols:"11",class:"pr-2"},{default:t(()=>o[4]||(o[4]=[a("div",{class:"text-h6 poppins-bold text-high-emphasis"},"Importar médicos pasantes de servicio social",-1),a("div",{class:"poppins-light text-medium-emphasis",style:{"font-size":"0.875rem"}}," Revisa y confirma los registros que se importarán al sistema ",-1)])),_:1,__:[4]}),e(c,{cols:"1",class:"d-flex justify-end"},{default:t(()=>[l.CargaImportacion?F("",!0):(_(),b(m,{key:0,icon:"mdi-close",variant:"text",onClick:z=>A.value=!1,density:"comfortable"},null,8,["onClick"]))]),_:2},1024)]),_:2},1024)]),_:2},1024),e(T,null,{default:t(()=>[q(e(u,null,{default:t(()=>[e(c,null,{default:t(()=>[e(C,{elevation:"0"},{default:t(()=>[l.DisponiblesdeImportacion.length>0?(_(),b(P,{key:0},{default:t(()=>[e(w,{class:"border-b-thin"},{default:t(()=>[a("div",ue,[e(f,{size:"small",color:"primary",class:"mr-2"},{default:t(()=>o[5]||(o[5]=[d(" mdi-database-check ")])),_:1,__:[5]}),a("span",ve,[a("span",fe,r(l.DisponiblesdeImportacion.length),1),o[6]||(o[6]=a("span",{class:"mx-1"},"registros a importar",-1))])])]),_:1}),e(L,{eager:""},{default:t(()=>[e(v,{class:"rounded-lg px-4"},{default:t(()=>[e(y,{items:l.DisponiblesdeImportacion,"max-height":400,"item-height":"72"},{default:t(({item:z,index:E})=>[e(h,{class:Y(["border-bottom py-2 ma-2 bg-grey-lighten-4 rounded-lg",{"hover:bg-grey-lighten-4":!0}])},{prepend:t(()=>[e(N,{color:"primary",size:"32",class:"elevation-1"},{default:t(()=>[e(f,{color:"white",size:"x-small"},{default:t(()=>o[7]||(o[7]=[d("mdi-account")])),_:1,__:[7]})]),_:1})]),default:t(()=>[a("div",ge,[e(x,{class:"poppins-semibold text-body-2 mb-1"},{default:t(()=>[a("span",xe,"# "+r(E+1),1),d(" "+r(z.nombre)+" "+r(z.primer_apellido)+" "+r(z.segundo_apellido),1)]),_:2},1024),a("div",ye,[a("div",be,[e(M,{size:"x-small",color:"primary",variant:"tonal",class:"text-none elevation-0"},{default:t(()=>[d(" Consultorio: "+r(z.nombre_dependencia),1)]),_:2},1024)])]),a("div",he,[a("div",ke,[e(f,{size:"x-small",color:"primary",class:"mr-1"},{default:t(()=>o[8]||(o[8]=[d("mdi-card-account-details")])),_:1,__:[8]}),a("span",Ie,r(z.no_cuenta??"No.Cuenta no disponible"),1)]),a("div",Ce,[e(f,{size:"x-small",color:"primary",class:"mr-1"},{default:t(()=>o[9]||(o[9]=[d("mdi-email")])),_:1,__:[9]}),a("span",we,r(z.correo_institucional??"Correo no disponible"),1)])])])]),_:2},1024),e(i,{color:"grey"})]),_:1},8,["items"])]),_:1}),l.DisponiblesdeImportacion.length?F("",!0):(_(),H("div",Ae,[e(n,{icon:"mdi-account-group",text:"No hay registros para importar",title:"Sin datos"})]))]),_:1})]),_:1})):F("",!0)]),_:1})]),_:1})]),_:1},512),[[O,!l.CargaImportacion]]),q(e(u,null,{default:t(()=>[e(c,null,{default:t(()=>[e(C,{elevation:"0"},{default:t(()=>[l.NoDisponiblesdeImportacion.length>0?(_(),b(P,{key:0},{default:t(()=>[e(w,{class:"border-b-thin bg-red-lighten-5"},{default:t(()=>[a("div",ze,[e(f,{size:"small",color:"red-lighten-1",class:"mr-2"},{default:t(()=>o[10]||(o[10]=[d(" mdi-database-alert ")])),_:1,__:[10]}),a("span",Fe,[a("span",De,r(l.NoDisponiblesdeImportacion.length),1),o[11]||(o[11]=a("span",{class:"mx-1 text-red"},"registros no importables",-1))])])]),_:1}),e(L,{eager:""},{default:t(()=>[e(v,{class:"rounded-lg px-4"},{default:t(()=>[e(y,{items:l.NoDisponiblesdeImportacion,"max-height":400,"item-height":"72"},{default:t(({item:z,index:E})=>[e(h,{class:Y(["border-bottom py-2 ma-2 bg-grey-lighten-4 rounded-lg",{"hover:bg-grey-lighten-4":!0}])},{prepend:t(()=>[e(N,{color:"grey-lighten-1",size:"32",class:"elevation-1"},{default:t(()=>[e(f,{color:"white",size:"x-small"},{default:t(()=>o[12]||(o[12]=[d("mdi-account")])),_:1,__:[12]})]),_:1})]),default:t(()=>[a("div",Me,[e(x,{class:"poppins-semibold text-body-2 mb-1"},{default:t(()=>[a("span",Pe,"# "+r(E+1),1),d(" "+r(z.nombre)+" "+r(z.primer_apellido)+" "+r(z.segundo_apellido),1)]),_:2},1024),a("div",Ve,[a("div",Ne,[e(M,{size:"x-small",color:"grey",variant:"tonal",class:"text-none elevation-0"},{default:t(()=>[d(" Consultorio: "+r(z.nombre_dependencia),1)]),_:2},1024)])]),a("div",Le,[a("div",Se,[e(f,{size:"x-small",color:"grey",class:"mr-1"},{default:t(()=>o[13]||(o[13]=[d("mdi-card-account-details")])),_:1,__:[13]}),a("span",Ue,r(z.no_cuenta??"No.Cuenta no disponible"),1)]),a("div",He,[e(f,{size:"x-small",color:"grey",class:"mr-1"},{default:t(()=>o[14]||(o[14]=[d("mdi-email")])),_:1,__:[14]}),a("span",je,r(z.correo_institucional??"Correo no disponible"),1)])]),a("div",Re,[e(f,{size:"x-small",color:"error",class:"mr-1"},{default:t(()=>o[15]||(o[15]=[d("mdi-alert-circle")])),_:1,__:[15]}),a("span",Ee,r(z.error||"No disponible"),1)])])]),_:2},1024),e(i,{color:"grey"})]),_:1},8,["items"])]),_:1}),l.NoDisponiblesdeImportacion.length?F("",!0):(_(),H("div",qe,[e(n,{icon:"mdi-account-group",text:"No hay registros no importables",title:"Sin datos"})]))]),_:1})]),_:1})):F("",!0)]),_:1})]),_:1})]),_:1},512),[[O,!l.CargaImportacion]]),q(e(n,{icon:"mdi-file-document-outline",text:"El archivo seleccionado está vacío. Por favor, seleccione un archivo que contenga registros para importar.",title:"Archivo sin registros"},null,512),[[O,!l.CargaImportacion&&l.NoDisponiblesdeImportacion.length<1&&l.DisponiblesdeImportacion.length<1]]),q(e(n,{icon:"mdi-database-sync",text:"Por favor, no cierre esta ventana mientras se procesan los datos.",title:"Procesando datos"},{default:t(()=>[e(j,{indeterminate:""})]),_:1},512),[[O,l.CargaImportacion]])]),_:1}),q(e(G,null,{default:t(()=>[e(u,{class:"mx-4 mb-6"},{default:t(()=>[e(U),l.DisponiblesdeImportacion.length<1||l.NoDisponiblesdeImportacion.length>0?(_(),b(m,{key:0,color:"primary",variant:"outlined",class:"text-none mr-2",onClick:o[1]||(o[1]=z=>l.PreImportacionModal=!1)},{default:t(()=>[e(f,{icon:"mdi-close"}),o[16]||(o[16]=a("span",{class:"mx-2"},"Cerrar",-1))]),_:1,__:[16]})):F("",!0),l.DisponiblesdeImportacion.length>0?(_(),b(m,{key:1,color:"primary",variant:"elevated",class:"text-none",onClick:l.ImportacionMedicos},{default:t(()=>[e(f,{icon:"mdi-database-import-outline"}),o[17]||(o[17]=a("span",{class:"mx-2"},"Importar registros",-1))]),_:1,__:[17]},8,["onClick"])):F("",!0)]),_:1})]),_:1},512),[[O,!l.CargaImportacion]])]),_:2},1024)]),_:1},8,["modelValue"]),e(W)],64)}const Te=J(_e,[["render",$e]]),Oe={setup(){const V=p(!1),o=p([]),I=p(0),l=()=>{V.value=!1},g=le(()=>I.value?[{title:"Médico",key:"medico",sortable:!0},{title:"Dependencia",key:"consultorio",sortable:!0}]:[{title:"Médico",key:"medico",sortable:!0},{title:"Dependencia",key:"consultorio",sortable:!0},{title:"Motivo",key:"error",sortable:!0}]);return{dialog:V,headers:g,listaUsuarios:o,importados:I,closeDialog:l}}},Ye={class:"poppins-bold"},Ge={class:"d-flex align-center px-4 py-2 rounded-t-lg"},Be={class:"poppins-medium"},Qe={class:"font-weight-bold"},Je={class:"mx-1"},Ke={class:"d-flex flex-column my-2"},We={class:"text-medium-emphasis",style:{"font-size":"0.775rem"}},Xe={class:"d-flex align-center gap-2"},Ze={class:"d-flex align-center"},et={class:"d-flex align-center gap-2"},tt={class:"d-flex align-center"},ot={class:"poppins-medium text-medium-emphasis text-caption"},at={class:"d-flex align-center mx-2"},st={class:"poppins-medium text-medium-emphasis text-caption"},lt={key:0,class:"d-flex align-center mt-1"},nt={class:"poppins-regular text-grey-darken-2 text-caption"},it={key:0,class:"d-flex justify-center align-center py-8"};function rt(V,o,I,l,g,D){const m=s("v-col"),n=s("v-row"),c=s("v-container"),u=s("v-btn"),k=s("v-card-title"),f=s("v-icon"),w=s("v-avatar"),N=s("v-list-item-title"),x=s("v-chip"),M=s("v-list-item"),h=s("v-divider"),i=s("v-virtual-scroll"),y=s("v-list"),v=s("v-empty-state"),L=s("v-card-text"),P=s("v-spacer"),C=s("v-card-actions"),j=s("v-card"),T=s("v-dialog");return _(),b(T,{modelValue:l.dialog,"onUpdate:modelValue":o[0]||(o[0]=U=>l.dialog=U),"max-width":"650px",scrollable:"",scrim:"black",opacity:"0.80",origin:"top center",location:"top"},{default:t(()=>[e(j,{rounded:"xl"},{default:t(()=>[e(k,{class:"d-flex align-center pa-0"},{default:t(()=>[e(c,{fluid:"",class:"pa-0"},{default:t(()=>[e(n,{"no-gutters":"",class:"d-flex align-center"},{default:t(()=>[e(m,{cols:"11"},{default:t(()=>[e(c,{fluid:""},{default:t(()=>[e(n,{"no-gutters":"",class:"pa-4 mx-2"},{default:t(()=>[e(m,{cols:"12"},{default:t(()=>[a("span",Ye,"Registros "+r(l.importados?"importados":"no importados"),1)]),_:1}),e(m,{cols:"12",class:"text-wrap mt-n2"},{default:t(()=>o[1]||(o[1]=[a("span",{class:"text-medium-emphasis poppins-regular",style:{"font-size":"0.875rem"}},"Lista de usuarios que fueron procesados durante la importación.",-1)])),_:1,__:[1]})]),_:1})]),_:1})]),_:1}),e(m,{cols:"1",class:"ml-n5"},{default:t(()=>[e(u,{icon:"mdi-close",variant:"text",onClick:l.closeDialog},null,8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1}),e(L,{class:"mx-4 pa-0",style:{height:"80%"}},{default:t(()=>[a("div",Ge,[e(f,{size:"small",color:"primary",class:"mr-2"},{default:t(()=>[d(r(l.importados?"mdi-database-check":"mdi-database-alert"),1)]),_:1}),a("span",Be,[a("span",Qe,r(l.listaUsuarios.length),1),a("span",Je,"registros "+r(l.importados?"importados":"no importados"),1)])]),e(y,{class:"rounded-lg px-4"},{default:t(()=>[e(i,{items:l.listaUsuarios,"max-height":400,"item-height":"72"},{default:t(({item:U,index:G})=>[e(M,{class:Y(["border-bottom py-2 ma-2 bg-grey-lighten-4 rounded-lg",{"hover:bg-grey-lighten-4":!0}])},{prepend:t(()=>[e(w,{color:"primary",size:"32",class:"elevation-1"},{default:t(()=>[e(f,{color:"white",size:"x-small"},{default:t(()=>o[2]||(o[2]=[d("mdi-account")])),_:1,__:[2]})]),_:1})]),default:t(()=>[a("div",Ke,[e(N,{class:"poppins-semibold text-body-2 mb-1"},{default:t(()=>[a("span",We,"# "+r(G+1),1),d(" "+r(U.medico),1)]),_:2},1024),a("div",Xe,[a("div",Ze,[e(x,{size:"x-small",color:l.importados?"primary":"grey",variant:(l.importados,"tonal"),class:"text-none elevation-0"},{default:t(()=>[d(" Consultorio: "+r(U.consultorio??"No disponible o no registrado"),1)]),_:2},1032,["color","variant"])])]),a("div",et,[a("div",tt,[e(f,{size:"x-small",color:"primary",class:"mr-1"},{default:t(()=>o[3]||(o[3]=[d("mdi-card-account-details")])),_:1,__:[3]}),a("span",ot,r(U.cuenta??"No.Cuenta no disponible"),1)]),a("div",at,[e(f,{size:"x-small",color:"primary",class:"mr-1"},{default:t(()=>o[4]||(o[4]=[d("mdi-email")])),_:1,__:[4]}),a("span",st,r(U.correo_institucional??"Correo no disponible"),1)])]),!l.importados&&U.error?(_(),H("div",lt,[e(f,{size:"x-small",color:"error",class:"mr-1"},{default:t(()=>o[5]||(o[5]=[d("mdi-alert-circle")])),_:1,__:[5]}),a("span",nt,r(U.error),1)])):F("",!0)])]),_:2},1024),e(h,{color:"grey"})]),_:1},8,["items"])]),_:1}),l.listaUsuarios.length?F("",!0):(_(),H("div",it,[e(v,{icon:"mdi-account-group",text:"No hay usuarios para mostrar",title:"Sin datos"})]))]),_:1}),e(C,{class:"pa-4 mb-4 mr-4"},{default:t(()=>[e(P),e(u,{color:"grey-darken-2",variant:"outlined",onClick:l.closeDialog},{default:t(()=>o[6]||(o[6]=[d(" Cerrar ")])),_:1,__:[6]},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}const ct=J(Oe,[["render",rt]]),dt={components:{ImportacionListaUsuarios:ct},setup(){const V=$("tab"),o=p(""),I=p(!1),l=p([]),g=p(!1),D=Z(),m=p(null),n=p(!1),c=p(1),u=p([]),k=p(!1),f=p(null),w=p([]),N=p(!1),x=p(0),M="/importaciones",h=[{title:"Fecha",key:"fecha",sortable:!0},{title:"Estado",key:"estado",sortable:!0},{title:"Total registros",key:"total_registros",sortable:!0},{title:"Registros importados",key:"registros_importados",sortable:!0},{title:"Acciones",key:"acciones",sortable:!1}],i=async()=>{c.value=1,await y()},y=async()=>{const P=`${M}/historial`;var C={params:{pagina:c.value}};await axios.get(P,C).then(j=>{console.log("ok"),u.value=j.data.data??[],x.value=j.data.last_page??0}).catch(j=>{u.value=[],x.value=0}).finally(()=>{n.value=!1})};return{search:o,loading:I,importaciones:l,headers:h,detallesModal:g,importacionSeleccionada:m,HistorialdeImportaciones:u,HistorialImportaciones:i,showListaRegistros:(P,C)=>{f.value.dialog=!0,f.value.listaUsuarios=P,f.value.importados=C,console.log("aqui modal")},MostrarListaUsuarios:k,ImportacionListaUsuariosRef:f,ListaUsuariosenImportacion:w,RegistroImportado:N,LastPage:x,pestaniaImportacion:V,ObtenerHistorial:y,LoaderInformacion:n,PeticionObtenerHistorialPorPagina:()=>{n.value=!0,D.debounce(y,350)()},PaginaHistorialImportacion:c}}},mt={class:"d-flex align-center"},pt={class:"poppins-semibold"},_t={class:"pa-0 text-no-wrap"},ut={class:"text-high-emphasis poppins-medium"},vt={class:"poppins-regular text-medium-emphasis",style:{"font-size":"0.775rem"}},ft={class:"pa-0 text-no-wrap"},gt={class:"poppins-medium text-medium-emphasis mx-2"},xt={class:"pa-0 text-no-wrap"},yt={class:"pa-0 text-no-wrap"},bt={colspan:"3"};function ht(V,o,I,l,g,D){const m=s("v-icon"),n=s("v-col"),c=s("v-row"),u=s("v-progress-linear"),k=s("v-container"),f=s("v-avatar"),w=s("v-chip"),N=s("v-table"),x=s("v-pagination"),M=s("v-btn"),h=s("v-empty-state"),i=s("ImportacionListaUsuarios"),y=ne("tooltip");return _(),b(k,{fluid:""},{default:t(()=>[e(c,{class:"mt-4 mx-4","no-gutters":""},{default:t(()=>[e(n,{cols:"12"},{default:t(()=>[a("div",mt,[e(m,{icon:"mdi-database",color:"primary",size:"28",class:"me-3"}),o[2]||(o[2]=a("div",null,[a("div",{class:"text-h5 poppins-bold text-high-emphasis mb-1"},"Historial de importaciones"),a("div",{class:"poppins-regular text-medium-emphasis",style:{"font-size":"0.9375rem"}}," Registro de todas las importaciones realizadas en el sistema ")],-1))])]),_:1})]),_:1}),e(c,{class:"mt-10 mx-5","no-gutters":""},{default:t(()=>[l.HistorialdeImportaciones.length>0?(_(),b(n,{key:0,cols:"12"},{default:t(()=>[l.LoaderInformacion?(_(),b(u,{key:0,indeterminate:"",color:"primary",height:"4",class:"rounded-pill"})):F("",!0),e(N,{class:"border-thin rounded-lg",density:"compact"},{default:t(()=>[o[5]||(o[5]=a("thead",null,[a("tr",null,[a("th",{class:"text-grey-darken-2"}," # "),a("th",{class:"text-grey-darken-2"}," Fecha creación "),a("th",{class:"text-grey-darken-2"}," Creada por "),a("th",{class:"text-grey-darken-2 text-center"}," Registros importados "),a("th",{class:"text-grey-darken-2 text-center"}," Registros no importados ")])],-1)),a("tbody",null,[(_(!0),H(B,null,ae(l.HistorialdeImportaciones,v=>(_(),H("tr",null,[a("td",null,[e(k,{fluid:""},{default:t(()=>[e(c,{"no-gutters":"",class:"d-flex align-center"},{default:t(()=>[e(n,{cols:"12"},{default:t(()=>[a("span",pt,r(v.index),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),a("td",_t,[e(k,{fluid:""},{default:t(()=>[e(c,{"no-gutters":"",class:"d-flex align-center"},{default:t(()=>[e(n,{cols:"12"},{default:t(()=>[e(m,{class:"mr-2",size:"15",color:"primary"},{default:t(()=>o[3]||(o[3]=[d("mdi-calendar")])),_:1,__:[3]}),a("span",ut,r(v.fecha_creacion),1)]),_:2},1024),e(n,{cols:"12"},{default:t(()=>[a("span",vt,"No. Lote "+r(v.hID),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),a("td",ft,[e(k,{fluid:""},{default:t(()=>[e(c,{"no-gutters":"",class:"d-flex align-center"},{default:t(()=>[e(n,null,{default:t(()=>[e(f,{color:"blue",size:"22",rounded:""},{default:t(()=>[e(m,{size:"18"},{default:t(()=>o[4]||(o[4]=[d("mdi-account")])),_:1,__:[4]})]),_:1}),a("span",gt,r(v.usuario),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),a("td",xt,[e(k,{fluid:""},{default:t(()=>[e(c,{"no-gutters":"",class:"d-flex align-center text-center"},{default:t(()=>[e(n,null,{default:t(()=>[e(w,{onClick:L=>v.registros_importados.length>0?l.showListaRegistros(v.registros_importados,!0):void 0,class:Y(v.registros_importados.length>0?"text-decoration-underline cursor-pointer":void 0),color:v.registros_importados.length>0?"blue":void 0,variant:"tonal"},{default:t(()=>[d(r(v.registros_importados.length),1)]),_:2},1032,["onClick","class","color"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),a("td",yt,[e(k,{fluid:""},{default:t(()=>[e(c,{"no-gutters":"",class:"d-flex align-center text-center"},{default:t(()=>[e(n,null,{default:t(()=>[q((_(),b(w,{onClick:L=>v.registros_no_importados.length>0?l.showListaRegistros(v.registros_no_importados,!1):void 0,class:Y(v.registros_no_importados.length>0?"text-decoration-underline cursor-pointer":void 0),color:v.registros_no_importados.length>0?"red":void 0,variant:"tonal"},{default:t(()=>[d(r(v.registros_no_importados.length),1)]),_:2},1032,["onClick","class","color"])),[[y,"Ver"]])]),_:2},1024)]),_:2},1024)]),_:2},1024)])]))),256))])]),_:1,__:[5]}),a("tfoot",null,[a("tr",null,[a("td",bt,[e(x,{disabled:l.LoaderInformacion,density:"default","onUpdate:modelValue":[l.PeticionObtenerHistorialPorPagina,o[0]||(o[0]=v=>l.PaginaHistorialImportacion=v)],length:l.LastPage,modelValue:l.PaginaHistorialImportacion,"total-visible":5,color:"primary"},null,8,["disabled","onUpdate:modelValue","length","modelValue"])])])])]),_:1})):(_(),b(n,{key:1,cols:"12"},{default:t(()=>[e(h,{icon:"mdi-database-search",text:"No hay importaciones disponibles para visualizar en este momento. Realiza una nueva importación para comenzar a registrar médicos pasantes.",title:"Sin importaciones disponibles"},{actions:t(()=>[e(M,{color:"primary",onClick:o[1]||(o[1]=v=>l.pestaniaImportacion=1)},{default:t(()=>o[6]||(o[6]=[d("Nueva importación")])),_:1,__:[6]})]),_:1})]),_:1}))]),_:1}),e(i,{ref:"ImportacionListaUsuariosRef"},null,512)]),_:1})}const kt=J(dt,[["render",ht],["__scopeId","data-v-f22fc61c"]]),It={__name:"ImportacionesAdm",setup(V){const o=$("MostrarFiltros"),I=$("aplicarFiltros"),l=$("limpiarFiltros"),g=$("FechaInicioFiltro"),D=$("FechaFinFiltro");return(m,n)=>{const c=s("v-col"),u=s("v-btn"),k=s("v-row"),f=s("v-divider"),w=s("v-date-input"),N=s("v-spacer"),x=s("v-icon"),M=s("v-card"),h=s("v-navigation-drawer");return _(),b(h,{modelValue:S(o),"onUpdate:modelValue":n[3]||(n[3]=i=>X(o)?o.value=i:null),location:"right",width:"400",scrim:"black",temporary:"",persistent:"","disable-resize-watcher":"",floating:""},{default:t(()=>[e(M,{flat:"",class:"pa-4",color:"grey-lighten-4",style:{"min-height":"100vh"}},{default:t(()=>[e(k,{align:"center",class:"mb-2 mt-n2","no-gutters":""},{default:t(()=>[e(c,null,{default:t(()=>n[4]||(n[4]=[a("span",{style:{"font-size":"1rem","font-weight":"600"}},"Filtros de búsqueda",-1)])),_:1,__:[4]}),e(c,{cols:"auto"},{default:t(()=>[e(u,{icon:"mdi-close",variant:"text",onClick:n[0]||(n[0]=i=>o.value=!1)})]),_:1})]),_:1}),e(f,{class:"mb-4"}),e(k,{dense:"",align:"end",class:"mt-n2"},{default:t(()=>[e(c,{cols:"12",md:"12"},{default:t(()=>[n[5]||(n[5]=a("span",{class:"text-caption text-grey-darken-1"},"Rango de fechas",-1)),e(w,{modelValue:S(g),"onUpdate:modelValue":n[1]||(n[1]=i=>X(g)?g.value=i:null),label:"Desde",variant:"outlined","bg-color":"white",density:"compact","prepend-icon":"","prepend-inner-icon":"mdi-calendar-start","hide-details":"",class:"mt-2"},null,8,["modelValue"])]),_:1,__:[5]}),e(c,{cols:"12",md:"12",class:"my-2"},{default:t(()=>[e(w,{modelValue:S(D),"onUpdate:modelValue":n[2]||(n[2]=i=>X(D)?D.value=i:null),label:"Hasta",variant:"outlined","prepend-icon":"",min:S(g),"bg-color":"white",density:"compact","prepend-inner-icon":"mdi-calendar-end","hide-details":""},null,8,["modelValue","min"])]),_:1}),e(c,{cols:"12",md:"12",class:"d-flex align-end justify-end ga-2 mb-3"},{default:t(()=>[e(N),e(u,{color:"primary",variant:"text",class:"text-none",onClick:S(l),rounded:"lg"},{default:t(()=>[e(x,{class:"mr-2",size:"15"},{default:t(()=>n[6]||(n[6]=[d("mdi-trash-can")])),_:1,__:[6]}),n[7]||(n[7]=d(" Limpiar "))]),_:1,__:[7]},8,["onClick"]),e(u,{color:"primary",class:"text-none",onClick:S(I),rounded:"lg"},{default:t(()=>[e(x,{class:"mr-2",size:"15"},{default:t(()=>n[8]||(n[8]=[d("mdi-filter-check")])),_:1,__:[8]}),n[9]||(n[9]=d(" Aplicar "))]),_:1,__:[9]},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}},Ct={class:"chip-hid-text"},wt={class:"text-center"},At={class:"text-center"},zt={colspan:"6",class:"pa-0"},oe="/importaciones",Ft={__name:"ImportacionesPacientes",setup(V){ie(async()=>{await x()});const o=Z(),I=p(!1),l=p(1),g=p({data:[]}),D=p(null),m=p(null),n=p(!1),c=p(null),u=p(null),k=h=>{o.CallbackAlerta=null,D.value=null,D.value=h,o.MostrarAlerta=!0,o.IconoAlerta="mdi-alert-circle",o.EstadoAlerta=1,o.TituloAlerta="Confirmar eliminación de importación",o.MensajeAlerta="Todos los usuarios y registros asociados a esta importación serán eliminados permanentemente. ¿Está seguro de que desea continuar?",o.CallbackAlerta="EliminarImportacion"},f=async()=>{let h=`${oe}/${D.value}/eliminar-importacion`;var i,y,v,L,P;await axios.delete(h).then(C=>{i="Operación exitosa",y=C.data.message,v=2,L="mdi-check-circle",P="ObtenerListaImportaciones"}).catch(C=>{i="No se pudo eliminar",y=C.response.data?`${C.response.data.message}`:"Ocurrió un error. Por favor, inténtalo de nuevo más tarde.",v=2,L="mdi-close-circle",P=null}).finally(()=>{o.MostrarAlerta=!0,o.TituloAlerta=i,o.MensajeAlerta=y,o.EstadoAlerta=v,o.IconoAlerta=L,o.CallbackAlerta=P})},w=async()=>{c.value=null,u.value=null,n.value=!1,l.value=1,await x(),I.value=!1},N=async()=>{n.value=!1,(c.value||u.value)&&(n.value=!0),l.value=1,await M(),I.value=!1},x=async()=>{var h=`${oe}/historial`;await axios.get(h,{params:{pagina:l.value,busqueda:m.value,fecha_inicio:c.value,fecha_fin:u.value}}).then(i=>{g.value=[],g.value=i.data}).finally(()=>{o.MostrarAlerta=!1})},M=o.debounce(x,350);return R("MostrarFiltros",I),R("aplicarFiltros",N),R("limpiarFiltros",w),R("FechaInicioFiltro",c),R("FechaFinFiltro",u),R("FuncionesPadre",{EliminarImportacion:f,ObtenerListaImportaciones:x}),(h,i)=>{const y=s("v-col"),v=s("v-row"),L=s("v-text-field"),P=s("v-btn"),C=s("v-chip"),j=s("v-progress-linear"),T=s("v-tooltip"),U=s("v-icon"),G=s("v-pagination"),Q=s("v-container"),K=s("v-table"),W=s("v-empty-state");return _(),H(B,null,[e(se),e(It),e(Q,{fluid:""},{default:t(()=>[e(v,{class:"my-4 mx-5","no-gutters":""},{default:t(()=>[e(y,{cols:"12"},{default:t(()=>i[3]||(i[3]=[a("span",{class:"poppins-semibold seccion-titulo"},"Importación de Médicos Pasantes de Servicio Social",-1)])),_:1,__:[3]}),e(y,{cols:"12"},{default:t(()=>i[4]||(i[4]=[a("div",{class:"poppins-light text-grey-darken-1"}," Historial de importaciones de médicos pasantes de Servicio Social realizadas. ",-1)])),_:1,__:[4]})]),_:1}),e(v,{class:"mt-5 mx-5 mb-2","no-gutters":""},{default:t(()=>[e(y,{class:"d-flex align-center",cols:"6",sm:"6",md:"4"},{default:t(()=>[e(L,{"hide-details":"",modelValue:m.value,"onUpdate:modelValue":[i[0]||(i[0]=A=>m.value=A),S(M)],variant:"outlined",rounded:"lg","prepend-inner-icon":"mdi-magnify",density:"compact",placeholder:"Buscar por: No.Lote"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(y,{class:"d-flex align-center justify-end justify-sm-end justify-md-end justify-lg-end justify-xl-end"},{default:t(()=>[e(P,{onClick:i[1]||(i[1]=A=>I.value=!0),icon:"mdi-filter-variant",color:"primary",variant:"text"})]),_:1})]),_:1}),n.value&&!I.value?(_(),b(v,{key:0,class:"mx-2 mt-n2 mb-n1"},{default:t(()=>[e(y,{cols:"12"},{default:t(()=>[i[5]||(i[5]=a("span",{class:"text-caption text-grey-darken-1 mr-2"},"Filtros activos:",-1)),m.value?(_(),b(C,{key:0,color:"primary","text-color":"white",size:"small",class:"ma-1"},{default:t(()=>[d(" No.Lote : "+r(m.value),1)]),_:1})):F("",!0),c.value||u.value?(_(),b(C,{key:1,color:"primary","text-color":"white",size:"small",class:"ma-1"},{default:t(()=>[d(" Desde: "+r(S(te)(c.value).format("YYYY-MM-DD"))+" "+r(u.value?` a ${S(te)(u.value).format("YYYY-MM-DD")}`:null),1)]),_:1})):F("",!0)]),_:1,__:[5]})]),_:1})):F("",!0),e(v,{class:"mx-5 mt-1","no-gutters":""},{default:t(()=>[g.value.data.length>0?(_(),b(y,{key:0,cols:"12",class:"border-thin rounded-lg"},{default:t(()=>[S(o).LoaderPeticionenCurso?(_(),b(j,{key:0,indeterminate:"",color:"primary",height:"4",class:"rounded-pill"})):F("",!0),e(K,{density:"compact"},{default:t(()=>[i[9]||(i[9]=a("thead",null,[a("tr",null,[a("th",{class:"text-left pa-3"},"Tipo de importación"),a("th",{class:"text-left pa-3"},"Número de lote"),a("th",{class:"text-left pa-3"},"Fecha de importación"),a("th",{class:"text-center pa-3"},"Cantidad de datos importados"),a("th",{class:"text-center pa-3"})])],-1)),a("tbody",null,[(_(!0),H(B,null,ae(g.value.data,(A,z)=>(_(),H("tr",{key:A.hID,class:Y([z%2===0?"bg-grey-lighten-4":"","hover-row"]),style:re(A.medicosActivos>0?"cursor:not-allowed;":"")},[i[8]||(i[8]=a("td",null,[a("span",{class:"text-medium-emphasis"}," Médico pasante ")],-1)),a("td",null,[e(C,{color:"primary",size:"small",class:"chip-hid","prepend-icon":"mdi-pound"},{default:t(()=>[a("span",Ct,r(A.hID),1)]),_:2},1024)]),a("td",null,[e(C,{color:"grey-darken-1","text-color":"#616161",size:"small","prepend-icon":"mdi-calendar"},{default:t(()=>[a("span",null,r(A.fecha_creacion),1)]),_:2},1024)]),a("td",wt,r(A.total_registros_importados),1),a("td",At,[A.medicosActivos>0?(_(),b(T,{key:0,text:"No se puede eliminar porque ya existen médicos activos en esta importación",location:"top"},{activator:t(({props:E})=>[e(C,ee({ref_for:!0},E,{color:"primary",size:"small","prepend-icon":"mdi-alert-circle-outline"}),{default:t(()=>i[6]||(i[6]=[d(" Médicos activos ")])),_:2,__:[6]},1040)]),_:1})):(_(),b(T,{key:1,text:"Eliminar importación",location:"top"},{activator:t(({props:E})=>[e(P,ee({ref_for:!0},E,{icon:"",color:"primary",variant:"text",size:"small",onClick:Mt=>k(A.hID)}),{default:t(()=>[e(U,null,{default:t(()=>i[7]||(i[7]=[d("mdi-trash-can")])),_:1,__:[7]})]),_:2},1040,["onClick"])]),_:2},1024))])],6))),128))]),a("tfoot",null,[a("tr",null,[a("td",zt,[e(Q,{fluid:"",class:"pa-0"},{default:t(()=>[e(v,{"no-gutters":""},{default:t(()=>[e(y,{class:"d-flex justify-start align-center"},{default:t(()=>[g.value.last_page>1?(_(),b(G,{key:0,modelValue:l.value,"onUpdate:modelValue":[i[2]||(i[2]=A=>l.value=A),x],elevation:"0",variant:"elevated","active-color":"primary",rounded:"",density:"compact",length:g.value.last_page,"total-visible":5},null,8,["modelValue","length"])):F("",!0)]),_:1}),e(y,{class:"d-flex align-center justify-end text-primary poppins-light px-2"},{default:t(()=>[d(" Mostrando "+r(g.value.to)+" de "+r(g.value.total)+" registros ",1)]),_:1})]),_:1})]),_:1})])])])]),_:1,__:[9]})]),_:1})):(_(),b(y,{key:1,class:"mt-10"},{default:t(()=>[e(W,{icon:"mdi-database-off-outline",text:"No hay importaciones registradas, o no se encontró ninguna coincidencia con los filtros aplicados o la búsqueda.",title:"Sin importaciones encontradas"})]),_:1}))]),_:1})]),_:1})],64)}}},Dt=J(Ft,[["__scopeId","data-v-60e6542c"]]),Rt={__name:"MedicosPSS",props:{breadcrumbs:Array},setup(V){p(null);const o=p(1),I=p(null);p(!1);const l=ce(),g=async()=>{console.log("Aqui entra"),await me(),o.value=2,await I.value.HistorialImportaciones()};return R("GetHistorialImportaciones",g),R("tab",o),(D,m)=>{const n=s("v-col"),c=s("v-row"),u=s("v-tab"),k=s("v-tabs"),f=s("v-container");return _(),H(B,null,[e(S(de),{title:"Importaciones"}),e(pe,{breadcrumbs:V.breadcrumbs},{default:t(()=>[S(l).props.session.rolUsuario==2?(_(),b(f,{key:0,fluid:""},{default:t(()=>[e(c,{class:"my-4 mx-5","no-gutters":""},{default:t(()=>[e(n,{cols:"12"},{default:t(()=>m[1]||(m[1]=[a("span",{class:"poppins-semibold seccion-titulo"},"Importación de Médicos Pasantes de Servicio Social",-1)])),_:1,__:[1]}),e(n,{cols:"12"},{default:t(()=>m[2]||(m[2]=[a("div",{class:"poppins-light text-grey-darken-1"}," Historial de importaciones de médicos pasantes de Servicio Social realizadas. ",-1)])),_:1,__:[2]})]),_:1}),e(c,{class:"mt-10 mx-5","no-gutters":""},{default:t(()=>[e(n,{cols:"12"},{default:t(()=>[e(k,{modelValue:o.value,"onUpdate:modelValue":m[0]||(m[0]=w=>o.value=w),color:"primary"},{default:t(()=>[e(u,{value:1,class:"mr-2",variant:"tonal",rounded:"t-lg"},{default:t(()=>m[3]||(m[3]=[d("Nueva")])),_:1,__:[3]}),e(u,{value:2,variant:"tonal",rounded:"t-lg",onClick:g},{default:t(()=>m[4]||(m[4]=[d("Historial")])),_:1,__:[4]})]),_:1},8,["modelValue"])]),_:1})]),_:1}),o.value==1?(_(),b(Te,{key:0})):F("",!0),q(e(kt,{ref_key:"HistorialImportacionRef",ref:I},null,512),[[O,o.value==2]])]),_:1})):F("",!0),S(l).props.session.rolUsuario==1?(_(),b(Dt,{key:1})):F("",!0)]),_:1},8,["breadcrumbs"])],64)}}};export{Rt as default};
