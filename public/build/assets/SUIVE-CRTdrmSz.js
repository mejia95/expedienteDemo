import{o as B,r as p,q as w,p as N,b as s,j as O,d as M,e as o,g as b,z as $,w as t,f as n,h as r,F as Y,y as G}from"./app-bY3qV11d.js";import{h as H}from"./moment-C5S46NFB.js";import{_ as J}from"./App-DXzjI6g8.js";import{A as K}from"./AppStore-B5dmMze3.js";import{A as Q}from"./AppAlerta-CEk7FTVV.js";/* empty css            *//* empty css                                                                  */import"./_plugin-vue_export-helper-DlAUqK2U.js";const W={class:"d-flex align-center bg-grey-lighten-4 pa-4 rounded-lg"},X={class:"d-flex align-center rounded-lg mb-1"},Z={class:"poppins-semibold text-medium-emphasis text-grey-darken-3",style:{"font-size":"0.85rem"}},ee={class:"d-flex align-center mb-2 rounded-lg"},oe={class:"poppins-semibold text-medium-emphasis text-grey-darken-3",style:{"font-size":"0.85rem"}},te={class:"d-flex align-center rounded-lg"},ae={class:"poppins-semibold text-medium-emphasis text-grey-darken-3",style:{"font-size":"0.85rem"}},le="/api/catalogos",ne="/api",ve={__name:"SUIVE",props:{breadcrumbs:Array,ruta_valor:String},setup(A){const d=K();B(async()=>{_.value=await U(),await E()});const x=w(()=>a.value.consultorios.length===_.value.length),k=w(()=>a.value.consultorios.length>0),D=p([{title:"Diagnóstico Sindromático",valor:1},{title:"Diagnóstico Etiológico",valor:2},{title:"Diagnóstico Diferencial",valor:3}]),V=p([]),I=p(1),z=p(new Date),F=p(new Date),_=p([]),a=p({diagnostico:1,fechaInicial:new Date,fechaFinal:new Date,consultorios:[]}),E=()=>{if(x.value)a.value.consultorios=[];else{const u=[];_.value.forEach(e=>{u.push(e.id)}),a.value.consultorios=u,V.value=u}},R=async u=>{a.value.fechaFinal<u&&await G(()=>{a.value.fechaFinal=null})},U=async()=>{const u=`${le}/consultorios`;var e=[];return await axios.get(u).then(l=>{e=l.data}).catch(l=>{console.log(l)}),e},h=()=>{a.value.diagnostico=I.value,a.value.consultorios=V.value,a.value.fechaInicial=z.value,a.value.fechaInicial=F.value},P=async()=>{var u=`${ne}/reportes/suive-obtener`;const e={params:{tipoDiagnostico:a.value.diagnostico,comunidades:a.value.consultorios,fechaInicioReporte:a.value.fechaInicial,fechaCierreReporte:a.value.fechaFinal},timeout:18e3,responseType:"blob"};await axios.get(u,e).then(async l=>{console.log("Ok");var i=H().format("YYYY_MM_DD_H_m_s"),v=D.value.find(C=>C.valor==a.value.diagnostico),g=v.title,f=`ReporteSUIVE ${g} ${i}.xlsx`;f=f.replace(/ /g,"");const y=window.URL.createObjectURL(new Blob([l.data])),c=document.createElement("a");c.href=y,c.setAttribute("download",f),c.setAttribute("target","_blank"),document.body.appendChild(c),c.click(),d.LoaderPeticionenCurso=!1}).catch(l=>{console.log(l),d.LoaderPeticionenCurso=!1;var i=l.code=="ECONNABORTED"?"El tiempo de espera para generar el reporte ha finalizado. Por favor, intenta modificando los filtros de búsqueda o intenta nuevamente más tarde.":"No se han encontrado datos disponibles para generar el reporte solicitado. Por favor, verifique los parámetros de búsqueda o intente nuevamente más tarde.";d.IconoAlerta="mdi-alert-circle",d.TituloAlerta="Error",d.MostrarAlerta=!0,d.EstadoAlerta=2,d.MensajeAlerta=i,d.CallbackAlerta=null})},T=d.debounce(P,350);return N("FuncionesPadre",{}),(u,e)=>{const l=s("v-col"),i=s("v-row"),v=s("v-icon"),g=s("v-tooltip"),f=s("v-autocomplete"),y=s("v-date-input"),c=s("v-checkbox-btn"),C=s("v-list-item"),L=s("v-divider"),S=s("v-btn"),j=s("v-card"),q=s("v-container");return M(),O(Y,null,[o(b($),{title:"Reporte SUIVE"}),o(J,{breadcrumbs:A.breadcrumbs},{default:t(()=>[o(Q),o(q,{fluid:""},{default:t(()=>[o(i,{class:"my-4 mx-5","no-gutters":""},{default:t(()=>[o(l,{cols:"12"},{default:t(()=>e[4]||(e[4]=[n("span",{class:"poppins-semibold seccion-titulo"},"Reporte SUIVE",-1)])),_:1,__:[4]}),o(l,{cols:"12"},{default:t(()=>e[5]||(e[5]=[n("div",{class:"poppins-light text-grey-darken-1"}," Completa todos los filtros requeridos para generar y descargar el reporte SUIVE en formato Excel, utilizando la información que ingreses a continuación. ",-1)])),_:1,__:[5]})]),_:1}),o(i,{class:"mt-10 mx-5","no-gutters":""},{default:t(()=>[o(l,{cols:"12"},{default:t(()=>[o(j,{class:"rounded-lg",elevation:"0"},{default:t(()=>[o(i,{"no-gutters":""},{default:t(()=>[o(l,null,{default:t(()=>[n("div",W,[o(v,{color:"primary",class:"me-2",size:"15"},{default:t(()=>e[6]||(e[6]=[r("mdi-file-excel")])),_:1,__:[6]}),e[7]||(e[7]=n("div",{class:"poppins-semibold text-grey-darken-3",style:{"font-size":"0.98rem"}},"Genera y descarga el reporte SUIVE en Excel con los datos seleccionados",-1))])]),_:1})]),_:1}),o(i,{"no-gutters":"",class:"mt-8 mb-6 px-8"},{default:t(()=>[o(l,null,{default:t(()=>[n("div",X,[o(v,{color:"primary",class:"me-2",size:"13"},{default:t(()=>e[8]||(e[8]=[r("mdi-stethoscope")])),_:1,__:[8]}),n("span",Z,[e[10]||(e[10]=r("Diagnóstico ")),e[11]||(e[11]=n("span",{class:"text-red"},"*",-1)),o(g,{activator:"parent",location:"top"},{default:t(()=>e[9]||(e[9]=[r("Selecciona el tipo de diagnóstico para filtrar el reporte.")])),_:1,__:[9]})])]),o(f,{density:"compact",width:"60%",rounded:"lg",variant:"outlined",modelValue:a.value.diagnostico,"onUpdate:modelValue":e[0]||(e[0]=m=>a.value.diagnostico=m),"bg-color":"white",clearable:"","item-value":"valor","item-title":"title",class:"mb-4",color:"primary",placeholder:"(ej. Sindromático, Diferencial)",flat:"","hide-details":"",items:D.value||[]},null,8,["modelValue","items"]),e[12]||(e[12]=n("div",{class:"text-grey-darken-1 mt-1",style:{"font-size":"0.8rem"}},"Elige el diagnóstico principal del reporte.",-1))]),_:1,__:[12]})]),_:1}),o(i,{"no-gutters":"",class:"mt-8 mb-6 px-8"},{default:t(()=>[o(l,null,{default:t(()=>[n("div",ee,[o(v,{color:"primary",class:"me-2",size:"13"},{default:t(()=>e[13]||(e[13]=[r("mdi-calendar-range")])),_:1,__:[13]}),n("span",oe,[e[15]||(e[15]=r("Periodo ")),e[16]||(e[16]=n("span",{class:"text-red"},"*",-1)),o(g,{activator:"parent",location:"top"},{default:t(()=>e[14]||(e[14]=[r("Selecciona el rango de fechas del reporte.")])),_:1,__:[14]})])]),o(i,{class:"d-flex align-center"},{default:t(()=>[o(l,{cols:"12",md:"6"},{default:t(()=>[e[17]||(e[17]=n("span",{class:"poppins-light",style:{"font-size":"0.75rem"}},"Desde",-1)),o(y,{rounded:"lg","onUpdate:modelValue":[R,e[1]||(e[1]=m=>a.value.fechaInicial=m)],variant:"outlined",modelValue:a.value.fechaInicial,color:"primary",density:"compact",position:"sticky",placeholder:"Fecha de inicio (dd/mm/yyyy)",flat:""},null,8,["modelValue"])]),_:1,__:[17]}),o(l,{cols:"12",md:"6"},{default:t(()=>[e[18]||(e[18]=n("span",{class:"poppins-light",style:{"font-size":"0.75rem"}},"Hasta",-1)),o(y,{rounded:"lg",variant:"outlined",color:"primary",density:"compact",position:"sticky",modelValue:a.value.fechaFinal,"onUpdate:modelValue":e[2]||(e[2]=m=>a.value.fechaFinal=m),min:a.value.fechaInicial,placeholder:"Fecha de fin (dd/mm/yyyy)",flat:""},null,8,["modelValue","min"])]),_:1,__:[18]})]),_:1}),e[19]||(e[19]=n("div",{class:"text-grey-darken-1",style:{"font-size":"0.8rem"}},"Selecciona el periodo de tiempo para el reporte.",-1))]),_:1,__:[19]})]),_:1}),o(i,{"no-gutters":"",class:"mt-8 mb-6 px-8"},{default:t(()=>[o(l,null,{default:t(()=>[n("div",te,[o(v,{color:"primary",class:"me-2",size:"13"},{default:t(()=>e[20]||(e[20]=[r("mdi-hospital-building")])),_:1,__:[20]}),n("span",ae,[e[22]||(e[22]=r("Consultorios ")),e[23]||(e[23]=n("span",{class:"text-red"},"*",-1)),o(g,{activator:"parent",location:"top"},{default:t(()=>e[21]||(e[21]=[r("Selecciona uno o varios consultorios.")])),_:1,__:[21]})])]),o(f,{"hide-details":"",rounded:"lg",variant:"outlined",multiple:"",clearable:"",modelValue:a.value.consultorios,"onUpdate:modelValue":e[3]||(e[3]=m=>a.value.consultorios=m),"item-value":"id","item-title":"nombre",color:"primary",placeholder:"Ejemplo: San Felipe Tlalmimilolpan, Capultitlan, etc.",flat:"",items:_.value||[]},{"prepend-item":t(()=>[o(C,{title:"Todas",color:"primary",onClick:E},{prepend:t(()=>[o(c,{color:(k.value,"primary"),indeterminate:k.value&&!x.value,"model-value":x.value},null,8,["color","indeterminate","model-value"])]),_:1}),o(L,{class:"mt-2"})]),_:1},8,["modelValue","items"]),e[24]||(e[24]=n("div",{class:"text-grey-darken-1 mt-1",style:{"font-size":"0.8rem"}},"Puedes seleccionar más de un consultorio.",-1))]),_:1,__:[24]})]),_:1}),o(i,{"no-gutters":""},{default:t(()=>[o(l,{class:"d-flex justify-end"},{default:t(()=>[o(S,{color:"primary",disabled:b(d).LoaderPeticionenCurso,variant:"text",onClick:h,rounded:"lg","prepend-icon":"mdi-microsoft-excel"},{default:t(()=>e[25]||(e[25]=[r(" Limpiar campos ")])),_:1,__:[25]},8,["disabled"]),o(S,{color:"primary",loading:b(d).LoaderPeticionenCurso,rounded:"lg",onClick:b(T),"prepend-icon":"mdi-microsoft-excel"},{default:t(()=>e[26]||(e[26]=[r(" Generar ")])),_:1,__:[26]},8,["loading","onClick"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["breadcrumbs"])],64)}}};export{ve as default};
